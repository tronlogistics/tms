{% extends "layout.html" %}

{% block content %}
<!-- start: PAGE CONTENT -->
	<div class="row">
		<div class="col-sm-12">
			<!-- start: FORM WIZARD PANEL -->
			<div class="panel panel-default">
				<div class="panel-heading">
					<i class="fa fa-external-link-square"></i>
					Form Wizard
					<div class="panel-tools">
						<a class="btn btn-xs btn-link panel-collapse collapses" href="#">
						</a>
						<a class="btn btn-xs btn-link panel-config" href="#panel-config" data-toggle="modal">
							<i class="fa fa-wrench"></i>
						</a>
						<a class="btn btn-xs btn-link panel-refresh" href="#">
							<i class="fa fa-refresh"></i>
						</a>
						<a class="btn btn-xs btn-link panel-expand" href="#">
							<i class="fa fa-resize-full"></i>
						</a>
						<a class="btn btn-xs btn-link panel-close" href="#">
							<i class="fa fa-times"></i>
						</a>
					</div>
				</div>
				<div class="panel-body">
					<form action="#" role="form" class="smart-wizard form-horizontal" id="form">
						<div id="wizard" class="swMain">
							<ul>
								<li>
									<a href="#step-1">
										<div class="stepNumber">
											1
										</div>
										<span class="stepDesc"> General Info
											<br />
											<small>Input Basic Load Details</small> </span>
									</a>
								</li>
								<li>
									<a href="#step-2">
										<div class="stepNumber">
											2
										</div>
										<span class="stepDesc"> Plan Route
											<br />
											<small>Location Pick/Drop Details</small> </span>
									</a>
								</li>
								<li>
									<a href="#step-3">
										<div class="stepNumber">
											3
										</div>
										<span class="stepDesc"> Pick/Drop Info
											<br />
											<small>Location Pick/Drop Details</small> </span>
									</a>
								</li>
								<li>
									<a href="#step-3">
										<div class="stepNumber">
											3
										</div>
										<span class="stepDesc"> Assign Truck
											<br />
											<small>Assign a Truck</small> </span>
									</a>
								</li>
							</ul>
							<div class="progress progress-striped active progress-sm">
								<div aria-valuemax="100" aria-valuemin="0" role="progressbar" class="progress-bar progress-bar-success step-bar">
									<span class="sr-only"> 0% Complete (success)</span>
								</div>
							</div>
							<div id="step-1">
								<h2 class="StepTitle">Step 1 Content</h2>
								<div class="form-group">
									<label class="col-sm-3 control-label">
										Load # <span class="symbol required"></span>
										
									</label>
									<div class="col-sm-7">
										<input class="form-control" id="name" name="name" type="text" value="">
									</div>
								</div>
								<div class="form-group">
									<label class="col-sm-3 control-label">
										Load Type <span class="symbol required"></span>
										
									</label>
									<div class="col-sm-7">
										<select class="form-control" id="load_type" name="load_type"><option value="">&lt;none selected&gt;</option><option value="LTL">LTL</option><option value="TL">TL</option></select>
									</div>
								</div>
								<div class="form-group">
									<label class="col-sm-3 control-label">
										Required Trailer <span class="symbol required"></span>
										
									</label>
									<div class="col-sm-7">
										<select class="form-control" id="trailer_type" name="trailer_type"><option value="">&lt;none selected&gt;</option><option value="Auto Carrier">Auto Carrier</option><option value="Conestoga">Conestoga</option><option value="Container">Container</option><option value="Double Drop">Double Drop</option><option value="Flatbed">Flatbed</option><option value="Hotshot">Hotshot</option><option value="Lowboy">Lowboy</option><option value="Moving Van">Moving Van</option><option value="Power Only">Power Only</option><option value="Reefer">Reefer</option><option value="RGN">RGN</option><option value="Step Deck">Step Deck</option><option value="Tanker">Tanker</option><option value="Van">Van</option></select>
									</div>
								</div>
								<div class="form-group">
									<label class="col-sm-3 control-label">
										Total Miles <span class="symbol required"></span>
										
									</label>
									<div class="col-sm-7">
										<input class="form-control" id="total_miles" name="total_miles" placeholder="Total Miles" type="text" value="">
									</div>
								</div>
								<div class="form-group">
									<label class="col-sm-3 control-label">
										Max Weight (lbs) <span class="symbol required"></span>
										
									</label>
									<div class="col-sm-7">
										<input class="form-control" id="max_weight" name="max_weight" placeholder="Max Weight" type="text" value="">
									</div>
								</div>
								<div class="form-group">
									<label class="col-sm-3 control-label">
										Over Dimensional <span class="symbol required"></span>
										
									</label>
									<div class="col-sm-7">
										<div class="checkbox">
											<label>
												<input class="grey" id="over_dimensional" name="over_dimensional" type="checkbox" value="y">
											</label>
										</div>
									</div>
								</div>
								<div class="form-group">
									<label class="col-sm-3 control-label">
										Max Length <span class="symbol required"></span>
										
								        
									</label>
									<div class="col-sm-4">
										<input class="form-control" id="max_length" name="max_length" placeholder="Max Length" type="text" value="">
									</div>
									<div class="col-sm-3">
										<select class="form-control" id="max_length_type" name="max_length_type"><option value="">&lt;none selected&gt;</option><option value="Inches">in.</option><option value="Centimeters">cm.</option></select>
									</div>
								</div>
								<div class="form-group">
									<label class="col-sm-3 control-label">
										Max Width <span class="symbol required"></span>
										
								        
									</label>
									<div class="col-sm-4">
										<input class="form-control" id="max_width" name="max_width" placeholder="Max Width" type="text" value="">
									</div>
									<div class="col-sm-3">
										<select class="form-control" id="max_width_type" name="max_width_type"><option value="">&lt;none selected&gt;</option><option value="Inches">in.</option><option value="Centimeters">cm.</option></select>
									</div>
								</div>
								<div class="form-group">
									<label class="col-sm-3 control-label">
										Max Height <span class="symbol required"></span>
										
								        
									</label>
									<div class="col-sm-4">
										<input class="form-control" id="max_height" name="max_height" placeholder="Max Height" type="text" value="">
									</div>
									<div class="col-sm-3">
										<select class="form-control" id="max_height_type" name="max_height_type"><option value="">&lt;none selected&gt;</option><option value="Inches">in.</option><option value="Centimeters">cm.</option></select>
									</div>
								</div>
								<div class="form-group">
									<div class="col-sm-2 col-sm-offset-8">
										<button class="btn btn-blue next-step btn-block">
											Next <i class="fa fa-arrow-circle-right"></i>
										</button>
									</div>
								</div>
							</div>
							<div id="step-2">
								<h2 class="StepTitle">Step 2 Content</h2>
								<div class="row">
									<div class="col-md-12 space20">
										<button class="btn btn-green add-row">
											Add New <i class="fa fa-plus"></i>
										</button>
									</div>
								</div>
								<div class="table-responsive">
									<table class="table table-striped table-hover" id="sample_2">
										<thead>
											<tr>
												<th>Stop #</th>
												<th>Location Type</th>
												<th>City</th>
												<th>State</th>
												<th>Zip</th>
												<th>Arrival Date</th>
												<th>Delete</th>
											</tr>
										</thead>
										<tbody>
											{#{% for location in form.locations %}
												<tr>
													<td>{{ location.stop_number(class="form-control") }} {{ loop.index}}</td>
													<td>{{ location.stop_type(class="form-control") }}</td>
													<td>{{ location.city(class="form-control") }}</td>
													<td>{{ location.state(class="form-control") }}</td>
													<td>{{ location.postal_code(class="form-control") }}</td>
													<td><input type="text" id="locations-{{ loop.index }}-arrival_date" name="locations-{{ loop.index }}-arrival_date" data-date-format="dd-mm-yyyy" data-date-viewmode="years" class="form-control date-picker" value="{{ location.arrival_date.data }}"></td>
													<td><a class="delete-row" href="">Delete</a></td>
												</tr>
											{% endfor %}#}
											<!--- Content created by table-data.js -->
										</tbody>
									</table>
								</div>
								<div class="form-group">
									<div class="col-sm-2 col-sm-offset-3">
										<button class="btn btn-light-grey back-step btn-block">
											<i class="fa fa-circle-arrow-left"></i> Back
										</button>
									</div>
									<div class="col-sm-2 col-sm-offset-3">
										<button class="btn btn-blue populate-locations next-step btn-block">
											Next <i class="fa fa-arrow-circle-right"></i>
										</button>
									</div>
								</div>
							</div>
							<div id="step-3">
								<h2 class="StepTitle">Step 3 Title</h2>
								<div id="location-container">
								</div>
								<hr />
								<div class="form-group">
									<div class="col-sm-2 col-sm-offset-3">
										<button class="btn btn-light-grey back-step btn-block">
											<i class="fa fa-circle-arrow-left"></i> Back
										</button>
									</div>
									<div class="col-sm-2 col-sm-offset-3">
										<button class="btn btn-blue next-step btn-block">
											Next <i class="fa fa-arrow-circle-right"></i>
										</button>
									</div>
								</div>
							</div>
						</div>
					</form>
				</div>
			</div>
			<!-- end: FORM WIZARD PANEL -->
			<div id="location-template" style="display: none;">
				<div id="wrapper-__LOC_INDEX__">
					<div class="row bol-0-info">
						<div class="panel panel-white">
							<div class="panel-heading">
								<i class="clip-menu"></i>
								<span id="locations-__LOC_INDEX__-address">222 Kimberly Rd, Barrington, IL 60010 - Pickup</span>
								<div class="panel-tools">
									<a class="btn btn-xs btn-link panel-collapse collapses" href="#">
									</a>
									<a class="btn btn-xs btn-link panel-config" href="#panel-config" data-toggle="modal">
										<i class="fa fa-wrench"></i>
									</a>
									<a class="btn btn-xs btn-link panel-refresh" href="#">
										<i class="fa fa-refresh"></i>
									</a>
									<a class="btn btn-xs btn-link panel-close" href="#">
										<i class="fa fa-times"></i>
									</a>
								</div>
							</div>
							<div class="panel-body">
								<div id="locations-__LOC_INDEX__-bol-wrapper">
									
								</div>
							</div>
							<div class="row text-center">
								<button class="btn btn-primary" id="__LOC_INDEX__">Add Another BOL</button>
							</div>
						</div>
					</div>	
				</div>
			</div>
			<div id="bol-pickup-template" style="display:none;">
				<div class="row locations-__LOC_INDEX__-bol">
					<div class="row">
						<div class="col-sm-12">
							<h4>BOL #__BOL_NUMBER__</h4>
						</div>
					</div>
					<hr />
					<div class="row">
						<div class="col-sm-6">
							<div class="form-group">
								<label class="col-sm-3 control-label">
									BOL # <span class="symbol required"></span>
								</label>
								<div class="col-sm-7">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-bol_number" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-bol_number" class="form-control" value="">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-3 control-label">
									# Units <span class="symbol required"></span>
								</label>
								<div class="col-sm-7">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-number_units" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-number_units" class="form-control" value="">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-3 control-label">
									Weight <span class="symbol required"></span>
								</label>
								<div class="col-sm-7">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-weight" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-weight" class="form-control" value="">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-3 control-label">
									Commodity Type <span class="symbol required"></span>
								</label>
								<div class="col-sm-7">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-commodity_type" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-commodity_type" class="form-control" value="">
								</div>
							</div>
						</div>
						<div class="col-sm-6">
							<div class="form-group">
								<label class="col-sm-4 control-label">
									Length <span class="symbol required"></span>
								</label>
								<div class="col-sm-3">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_length" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_length" class="form-control" value="">
								</div>
								<div class="col-sm-4">
									<select class="form-control" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_length_type" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_length_type"><option value=""></option><option value="Inches">in.</option><option value="Centimeters">cm.</option></select>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">
									Width <span class="symbol required"></span>
								</label>
								<div class="col-sm-3">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_width" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_width" class="form-control" value="">
								</div>
								<div class="col-sm-4">
									<select class="form-control" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_width_type" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_width_type"><option value=""></option><option value="Inches">in.</option><option value="Centimeters">cm.</option></select>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">
									Height <span class="symbol required"></span>
								</label>
								<div class="col-sm-3">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_height" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_height" class="form-control" value="">
								</div>
								<div class="col-sm-4">
									<select class="form-control" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_height_type" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_height_type"><option value=""></option><option value="Inches">in.</option><option value="Centimeters">cm.</option></select>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div id="bol-dropoff-template" style="display:none;">
				<div class="row locations-__LOC_INDEX__-bol">
					<div class="col-sm-12">
						<h4>BOL #__BOL_NUMBER__</h4>
						<hr />
						<div class="form-group">
							<label class="col-sm-3 control-label">
								BOL # <span class="symbol required"></span>
							</label>
							<div class="col-sm-7">
								<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-bol_number" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-bol_number" class="form-control" value="">
							</div>
						</div>
						<div style="display:none;">
							<div class="form-group">
								<label class="col-sm-3 control-label">
									# Units <span class="symbol required"></span>
								</label>
								<div class="col-sm-7">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-number_units" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-number_units" class="form-control" value="">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-3 control-label">
									Weight <span class="symbol required"></span>
								</label>
								<div class="col-sm-7">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-weight" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-weight" class="form-control" value="">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-3 control-label">
									Commodity Type <span class="symbol required"></span>
								</label>
								<div class="col-sm-7">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-commodity_type" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-commodity_type" class="form-control" value="">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">
									Length <span class="symbol required"></span>
								</label>
								<div class="col-sm-3">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_length" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_length" class="form-control" value="">
								</div>
								<div class="col-sm-4">
									<select class="form-control" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_length_type" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_length_type"><option value=""></option><option value="Inches">in.</option><option value="Centimeters">cm.</option></select>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">
									Width <span class="symbol required"></span>
								</label>
								<div class="col-sm-3">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_width" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_width" class="form-control" value="">
								</div>
								<div class="col-sm-4">
									<select class="form-control" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_width_type" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_width_type"><option value=""></option><option value="Inches">in.</option><option value="Centimeters">cm.</option></select>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">
									Height <span class="symbol required"></span>
								</label>
								<div class="col-sm-3">
									<input type="text" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_height" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_height" class="form-control" value="">
								</div>
								<div class="col-sm-4">
									<select class="form-control" id="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_height_type" name="locations-__LOC_INDEX__-BOLs-__BOL_INDEX__-dim_height_type"><option value=""></option><option value="Inches">in.</option><option value="Centimeters">cm.</option></select>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end: PAGE CONTENT-->
	<!-- start: JAVASCRIPTS REQUIRED FOR THIS PAGE ONLY -->
	<script src="{{ static('backend/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js') }}"></script>
		<script src="{{ static('backend/plugins/jquery-validation/dist/jquery.validate.min.js') }}"></script>
		<script src="{{ static('backend/plugins/jQuery-Smart-Wizard/js/jquery.smartWizard.js') }}"></script>
		<script src="{{ static('backend/js/form-wizard.js') }}"></script>
		<script type="text/javascript" src="{{ static('backend/plugins/DataTables/media/js/jquery.dataTables.min.js') }}"></script>
		<script type="text/javascript" src="{{ static('backend/plugins/DataTables/media/js/DT_bootstrap.js') }}"></script>
		<script src="{{ static('backend/js/table-data.js') }}"></script>
		<!-- end: JAVASCRIPTS REQUIRED FOR THIS PAGE ONLY -->

	<script>
		$( document ).on( "focus", "input.date-picker", function() {
				$('.date-picker').datepicker({
			            autoclose: true,
			            format: "mm/dd/yyyy",
						minDate: 0
			        });
			});

		$(".populate-locations").mousedown(function(e){ //on add input button click
				var rows = $("#sample_2 tr").length;
				if(rows - 1 < 2) {
					alert("You must add a pickup & dropoff location.")
				}
				for( i = 1; i < rows; i++) {
					//get template and replace indexes
					var newRow = $('#location-template').html().replace(/__LOC_INDEX__/g, i - 1);
					//get template, replace applicable indexes
					var newBol;
					if($('#locations-' + i + '-stop_type').val() == "Pickup") {
						newBOL = $('#bol-pickup-template').html().replace(/__LOC_INDEX__/g, i - 1).replace(/__BOL_INDEX__/g, i - 1).replace(/__BOL_NUMBER__/g, 1);
					} else {
						newBOL = $('#bol-dropoff-template').html().replace(/__LOC_INDEX__/g, i - 1).replace(/__BOL_INDEX__/g, i - 1).replace(/__BOL_NUMBER__/g, 1);
					}

					//add location to screen
					$('#location-container').append(newRow);

					// add bol to location
					$('#locations-' + (i - 1) + '-bol-wrapper').append(newBOL);

					if($('#locations-' + i + '-stop_type').val() == "Pickup") {
						$('#' + (i-1)).addClass('add_pickup_button');
					} else {
						$('#' + (i-1)).addClass('add_dropoff_button');
					}

					//Set location title
					$('#locations-' + (i - 1) + '-address').text($('#locations-' + i + '-city').val() + ", " + $('#locations-' + i + '-state').val() + " " + $('#locations-' + i + '-postal_code').val());
					
				}
	        });
		$( document ).on( 'click', '.add_pickup_button', function(e) {
			e.preventDefault();
		   	var newBOL = $('#bol-pickup-template').html().replace(/__LOC_INDEX__/g, e.target.id).replace(/__BOL_INDEX__/g, $('#locations-' + e.target.id + '-bol-wrapper').length).replace(/__BOL_NUMBER__/g, $('.locations-' + e.target.id + '-bol').length + 1);
		   	$('#locations-' + e.target.id + '-bol-wrapper').append(newBOL);
		});
		$( document ).on( 'click', '.add_dropoff_button', function(e) {
			e.preventDefault();
		   	var newBOL = $('#bol-dropoff-template').html().replace(/__LOC_INDEX__/g, e.target.id).replace(/__BOL_INDEX__/g, $('#locations-' + e.target.id + '-bol-wrapper').length).replace(/__BOL_NUMBER__/g, $('.locations-' + e.target.id + '-bol').length + 1);
		   	$('#locations-' + e.target.id + '-bol-wrapper').append(newBOL);
		});
		
	</script>
	{% endblock %}