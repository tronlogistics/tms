{% extends "layout.html" %}

{% block content %}
<form name="create" action="" method="post" class="form-horizontal">
	{{ form.hidden_tag() }}
	<div class="row">
		<div class="col-sm-12">
			<div class="panel panel-default">
				<div class="panel-heading">
					<i class="fa fa-external-link-square"></i>
					Edit Truck
				</div>
				<div class="panel-body">
					<div class="form-group">
						<label class="col-sm-3 control-label" for="origin_address1">
							Truck Name<span class="symbol required"></span>
							{% for error in form.name.errors %}
					            <br><span style="color: red;">{{ error }}</span>
					          {% endfor %}
						</label>
						<div class="col-sm-9">
							{{ form.name(size=50, placeholder="Truck Name", class="form-control") }}
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label" for="origin_address1">
							Trailer Type<span class="symbol required"></span>
							{% for error in form.trailer_type.errors %}
					            <br><span style="color: red;">{{ error }}</span>
					          {% endfor %}
						</label>
						<div class="col-sm-9">
							{{ form.trailer_type(class="form-control") }}
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label" for="origin_address1">
							Max Weight
							{% for error in form.max_weight.errors %}
					            <br><span style="color: red;">{{ error }}</span>
					          {% endfor %}
						</label>
						<div class="col-sm-9">
							{{ form.max_weight(size=50, placeholder="Max Weight", class="form-control") }}
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label" for="origin_address1">
							Length
							{% for error in form.dim_length.errors %}
					            <br><span style="color: red;">{{ error }}</span>
					          {% endfor %}
						</label>
						<div class="col-sm-9">
							{{ form.dim_length(size=50, placeholder="Length", class="form-control") }}
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-3 control-label" for="origin_address1">
							Height
							{% for error in form.dim_height.errors %}
					            <br><span style="color: red;">{{ error }}</span>
					          {% endfor %}
						</label>
						<div class="col-sm-9">
							{{ form.dim_height(size=50, placeholder="Height", class="form-control") }}
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-3 control-label" for="origin_address1">
							Width
							{% for error in form.dim_width.errors %}
					            <br><span style="color: red;">{{ error }}</span>
					          {% endfor %}
						</label>
						<div class="col-sm-9">
							{{ form.dim_width(size=50, placeholder="Height", class="form-control") }}
						</div>
					</div>
					<hr>
					<div class="form-group">
						<div class="col-sm-2 col-sm-offset-3">
							<a class="btn btn-light-grey back-step btn-block" href="javascript:history.back()">
							<i class="fa fa-circle-arrow-left"></i> Cancel
						</a>
						</div>
						<div class="col-sm-2 col-sm-offset-3">
							<button type="submit" class="btn btn-blue next-step btn-block" id="submit">
								Submit <i class="fa fa-arrow-circle-right"></i>
							</button>
						</div>
					</div>
	        	</div>
	        </div>
     	</div>
	</div>

	<div class="row">
		<div class="col-sm-12">
			<div class="panel panel-default">
	    		<div class="panel-heading">
	        		<i class="fa fa-external-link-square"></i>
	        		Stop Offs 
	    		</div>
		    	<div class="panel-body">
		    		<table class="table table-condensed">
		    			<thead>
		    				<tr>
		    					<th>Up/Down</th>
	                            <th>Address</th>
	                            <th>Arrival Date</th>
	                            <!--<th>Status</th>-->
	                        </tr>
	                    </thead>
	                    <tbody>
				    			{% for location in locations|sort(attribute='stop_number') %}
					        		<tr class="location_order">
					        			<td>
					        				<a href="javascript:void()" class="up">Up</a>/<a href="javascript:void()" class="down">Down</a>

					        				<input type="hidden" id="locations-{{ loop.index }}-location_id" name="locations-{{ loop.index }}-location_id" class="form-control location-id" value="{{ location.id }}">

					        				<input type="text" id="locations-{{ loop.index }}-stop_number" name="locations-{{ loop.index }}-stop_number" class="form-control stop-number" value="{{ loop.index }}">

					        			</td>
		                            	<td>{{ location.address.address1 }}<br />{{ location.address.city }}, {{ location.address.state }} {{ location.address.postal_code }}</td>
		                            	<td>{{ location.arrival_date }}</td>
		                            </tr>
								{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>

</form>

<script>
$(document).ready(function(e){
    $(".up,.down,.top,.bottom").click(function(){
        var row = $(this).parents("tr:first");
        
		
        if ($(this).is(".up")) {
            row.insertBefore(row.prev());
        } else if ($(this).is(".down")) {
            row.insertAfter(row.next());
        } else if ($(this).is(".top")) {
            //row.insertAfter($("table tr:first"));
            row.insertBefore($("table tr:first"));
        }else {
            row.insertAfter($("table tr:last"));
        }
        var rowIndex = $(this)
		    .closest('tr') // Get the closest tr parent element
		    .prevAll() // Find all sibling elements in front of it
		    .length + 1; // Get their count
		$( ".location_order" ).each(function( index ) {
		  	$(this).find('.stop-number').val(index + 1);
		});
    });
});
</script>
{% endblock %}